{"ast":null,"code":"import { Observable } from '../Observable';\nimport { argsArgArrayOrObject } from '../util/argsArgArrayOrObject';\nimport { from } from './from';\nimport { identity } from '../util/identity';\nimport { mapOneOrManyArgs } from '../util/mapOneOrManyArgs';\nimport { popResultSelector, popScheduler } from '../util/args';\nimport { createObject } from '../util/createObject';\nimport { createOperatorSubscriber } from '../operators/OperatorSubscriber';\nimport { executeSchedule } from '../util/executeSchedule';\nexport function combineLatest() {\n  var args = [];\n  for (var _i = 0; _i < arguments.length; _i++) {\n    args[_i] = arguments[_i];\n  }\n  var scheduler = popScheduler(args);\n  var resultSelector = popResultSelector(args);\n  var _a = argsArgArrayOrObject(args),\n    observables = _a.args,\n    keys = _a.keys;\n  if (observables.length === 0) {\n    return from([], scheduler);\n  }\n  var result = new Observable(combineLatestInit(observables, scheduler, keys ? function (values) {\n    return createObject(keys, values);\n  } : identity));\n  return resultSelector ? result.pipe(mapOneOrManyArgs(resultSelector)) : result;\n}\nexport function combineLatestInit(observables, scheduler, valueTransform) {\n  if (valueTransform === void 0) {\n    valueTransform = identity;\n  }\n  return function (subscriber) {\n    maybeSchedule(scheduler, function () {\n      var length = observables.length;\n      var values = new Array(length);\n      var active = length;\n      var remainingFirstValues = length;\n      var _loop_1 = function (i) {\n        maybeSchedule(scheduler, function () {\n          var source = from(observables[i], scheduler);\n          var hasFirstValue = false;\n          source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            values[i] = value;\n            if (!hasFirstValue) {\n              hasFirstValue = true;\n              remainingFirstValues--;\n            }\n            if (!remainingFirstValues) {\n              subscriber.next(valueTransform(values.slice()));\n            }\n          }, function () {\n            if (! --active) {\n              subscriber.complete();\n            }\n          }));\n        }, subscriber);\n      };\n      for (var i = 0; i < length; i++) {\n        _loop_1(i);\n      }\n    }, subscriber);\n  };\n}\nfunction maybeSchedule(scheduler, execute, subscription) {\n  if (scheduler) {\n    executeSchedule(subscription, scheduler, execute);\n  } else {\n    execute();\n  }\n}","map":{"version":3,"names":["Observable","argsArgArrayOrObject","from","identity","mapOneOrManyArgs","popResultSelector","popScheduler","createObject","createOperatorSubscriber","executeSchedule","combineLatest","args","_i","arguments","length","scheduler","resultSelector","_a","observables","keys","result","combineLatestInit","values","pipe","valueTransform","subscriber","maybeSchedule","Array","active","remainingFirstValues","i","source","hasFirstValue","subscribe","value","next","slice","complete","execute","subscription"],"sources":["../../../../src/internal/observable/combineLatest.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}