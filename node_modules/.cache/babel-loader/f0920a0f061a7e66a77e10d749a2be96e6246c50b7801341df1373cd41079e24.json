{"ast":null,"code":"import { info, getInfo, changeInfo, infoDelete } from \"@/api/api\";\nexport default {\n  name: \"InfoList\",\n  data() {\n    return {\n      tableData: [],\n      dialogFormVisible: false,\n      form: {\n        name: \"\",\n        sex: \"1\",\n        age: \"\",\n        father: \"\",\n        mother: \"\",\n        address: \"\",\n        time: \"\",\n        phone: \"\"\n      },\n      state: true,\n      formLabelWidth: \"80px\",\n      rules: {\n        name: [{\n          required: true,\n          message: \"请输入姓名\"\n        }],\n        sex: [{\n          required: true\n        }],\n        age: [{\n          required: true,\n          message: \"请输入年龄\"\n        }],\n        address: [{\n          required: true,\n          message: \"请输入地址\"\n        }],\n        time: [{\n          required: true\n        }],\n        phone: [{\n          required: true,\n          message: \"请输入联系方式\"\n        }]\n      },\n      total: 0\n    };\n  },\n  created() {\n    this.getData();\n  },\n  methods: {\n    del(row) {\n      this.$alert(\"确定删除？\", \"提示\", {\n        confirmButtonText: \"确定\",\n        callback: () => {\n          infoDelete(row.id).then(res => {\n            if (res.status === 200) {\n              this.getData();\n              this.$message({\n                message: res.data.message,\n                type: \"success\"\n              });\n            }\n          });\n        }\n      });\n    },\n    edit(row) {\n      this.form = {\n        ...row\n      }; // 不要把当行的值直接赋给form，这样会有一个bug就是你在修改时表单也会跟着改\n      this.state = false;\n      this.dialogFormVisible = true;\n      this.title = \"修改学生信息\";\n    },\n    closeInfo(form) {\n      this.dialogFormVisible = false;\n      this.$refs[form].resetFields();\n    },\n    addStudent() {\n      this.form = {\n        name: \"\",\n        sex: \"1\",\n        age: \"\",\n        father: \"\",\n        mother: \"\",\n        address: \"\",\n        time: \"\",\n        phone: \"\"\n      };\n      this.dialogFormVisible = true;\n      this.$nextTick(() => {\n        this.$refs[form].resetFields();\n      });\n      this.state = true;\n    },\n    getData() {\n      getInfo().then(res => {\n        if (res.status === 200) {\n          this.tableData = res.data.data;\n          this.total = res.data.total;\n        }\n      });\n    },\n    sure(form) {\n      this.$refs[form].validate(valid => {\n        if (valid) {\n          console.log(form, this.form);\n          if (this.state) {\n            info(this.form).then(res => {\n              console.log(res);\n              if (res.status === 200) {\n                this.getData();\n                this.dialogFormVisible = false;\n                this.$message({\n                  type: \"success\",\n                  message: res.data.message\n                });\n              }\n            });\n          } else {\n            changeInfo(this.form).then(res => {\n              if (res.status === 200) {\n                this.getData();\n                this.dialogFormVisible = false;\n                this.$message({\n                  type: \"success\",\n                  message: res.data.message\n                });\n              }\n            });\n          }\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["info","getInfo","changeInfo","infoDelete","name","data","tableData","dialogFormVisible","form","sex","age","father","mother","address","time","phone","state","formLabelWidth","rules","required","message","total","created","getData","methods","del","row","$alert","confirmButtonText","callback","id","then","res","status","$message","type","edit","title","closeInfo","$refs","resetFields","addStudent","$nextTick","sure","validate","valid","console","log"],"sources":["src/components/Student/InfoList.vue"],"sourcesContent":["<template>\n  <div class=\"infoList\">\n    <el-form :inline=\"true\" class=\"demo-form-inline\" size=\"small\">\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"addStudent\">新增</el-button>\n      </el-form-item>\n    </el-form>\n    <!--  -->\n    <el-table :data=\"tableData\" border style=\"width: 100%\">\n      <!-- width+180px 改成 align=\"center\" 居中显示去除滚动条 -->\n      <el-table-column prop=\"name\" label=\"姓名\" align=\"center\">\n      </el-table-column>\n      <el-table-column prop=\"sex\" label=\"性别\" align=\"center\">\n      </el-table-column>\n      <el-table-column prop=\"age\" label=\"年龄\" align=\"center\">\n      </el-table-column>\n      <el-table-column prop=\"father\" label=\"父亲\" align=\"center\">\n      </el-table-column>\n      <el-table-column prop=\"mother\" label=\"母亲\" align=\"center\">\n      </el-table-column>\n      <el-table-column prop=\"address\" label=\"家庭住址\" align=\"center\">\n      </el-table-column>\n      <el-table-column prop=\"time\" label=\"入校时间\" align=\"center\">\n      </el-table-column>\n      <el-table-column prop=\"phone\" label=\"联系方式\" align=\"center\">\n      </el-table-column>\n      <el-table-column label=\"操作\" align=\"center\">\n        <template slot-scope=\"scope\">\n          <el-button\n            type=\"danger\"\n            size=\"mini\"\n            icon=\"el-icon-delete\"\n            @click=\"del(scope.row)\"\n          >\n          </el-button>\n          <el-button\n            type=\"primary\"\n            size=\"mini\"\n            icon=\"el-icon-edit\"\n            @click=\"edit(scope.row)\"\n          >\n          </el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n    <!--  -->\n    <el-dialog\n      :title=\"state ? '添加学生信息' : '修改学生信息'\"\n      :visible.sync=\"dialogFormVisible\"\n      width=\"500px\"\n    >\n      <el-form :model=\"form\" :rules=\"rules\" ref=\"form\">\n        <el-form-item label=\"姓名\" :label-width=\"formLabelWidth\" prop=\"name\">\n          <el-input v-model=\"form.name\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"性别\" :label-width=\"formLabelWidth\" prop=\"sex\">\n          <el-radio v-model=\"form.sex\" label=\"1\">男</el-radio>\n          <el-radio v-model=\"form.sex\" label=\"2\">女</el-radio>\n        </el-form-item>\n        <el-form-item label=\"年龄\" :label-width=\"formLabelWidth\" prop=\"age\">\n          <el-input v-model=\"form.age\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n        <el-form-item\n          label=\"父亲姓名\"\n          :label-width=\"formLabelWidth\"\n          prop=\"father\"\n        >\n          <el-input v-model=\"form.father\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n        <el-form-item\n          label=\"母亲姓名\"\n          :label-width=\"formLabelWidth\"\n          prop=\"mother\"\n        >\n          <el-input v-model=\"form.mother\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n        <el-form-item\n          label=\"家庭住址\"\n          :label-width=\"formLabelWidth\"\n          prop=\"address\"\n        >\n          <el-input v-model=\"form.address\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n        <el-form-item\n          label=\"入校时间\"\n          :label-width=\"formLabelWidth\"\n          prop=\"time\"\n        >\n          <!-- formar value-formar 是elementui自带的 -->\n          <el-date-picker\n            v-model=\"form.time\"\n            align=\"right\"\n            format=\"yyyy年 mm 月 dd 日\"\n            value-format=\"yyyy-mm-dd\"\n            type=\"date\"\n            placeholder=\"选择日期\"\n          >\n          </el-date-picker>\n        </el-form-item>\n        <el-form-item\n          label=\"联系方式\"\n          :label-width=\"formLabelWidth\"\n          prop=\"phone\"\n        >\n          <el-input v-model=\"form.phone\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"closeInfo('form')\"> 取 消 </el-button>\n        <el-button type=\"primary\" @click=\"sure('form')\"> 确 定 </el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { info, getInfo, changeInfo, infoDelete } from \"@/api/api\";\nexport default {\n  name: \"InfoList\",\n  data() {\n    return {\n      tableData: [],\n      dialogFormVisible: false,\n      form: {\n        name: \"\",\n        sex: \"1\",\n        age: \"\",\n        father: \"\",\n        mother: \"\",\n        address: \"\",\n        time: \"\",\n        phone: \"\",\n      },\n      state: true,\n      formLabelWidth: \"80px\",\n      rules: {\n        name: [\n          {\n            required: true,\n            message: \"请输入姓名\",\n          },\n        ],\n        sex: [\n          {\n            required: true,\n          },\n        ],\n        age: [\n          {\n            required: true,\n            message: \"请输入年龄\",\n          },\n        ],\n        address: [\n          {\n            required: true,\n            message: \"请输入地址\",\n          },\n        ],\n        time: [\n          {\n            required: true,\n          },\n        ],\n        phone: [\n          {\n            required: true,\n            message: \"请输入联系方式\",\n          },\n        ],\n      },\n      total: 0,\n    };\n  },\n  created() {\n    this.getData();\n  },\n  methods: {\n    del(row) {\n      this.$alert(\"确定删除？\", \"提示\", {\n        confirmButtonText: \"确定\",\n        callback: () => {\n          infoDelete(row.id).then((res) => {\n            if (res.status === 200) {\n              this.getData();\n              this.$message({ message: res.data.message, type: \"success\" });\n            }\n          });\n        },\n      });\n    },\n    edit(row) {\n      this.form = { ...row }; // 不要把当行的值直接赋给form，这样会有一个bug就是你在修改时表单也会跟着改\n      this.state = false;\n      this.dialogFormVisible = true;\n      this.title = \"修改学生信息\";\n    },\n    closeInfo(form) {\n      this.dialogFormVisible = false;\n      this.$refs[form].resetFields();\n    },\n    addStudent() {\n      this.form = {\n        name: \"\",\n        sex: \"1\",\n        age: \"\",\n        father: \"\",\n        mother: \"\",\n        address: \"\",\n        time: \"\",\n        phone: \"\",\n      };\n      this.dialogFormVisible = true;\n      this.$nextTick(() => {\n        this.$refs[form].resetFields();\n      });\n      this.state = true;\n    },\n    getData() {\n      getInfo().then((res) => {\n        if (res.status === 200) {\n          this.tableData = res.data.data;\n          this.total = res.data.total;\n        }\n      });\n    },\n    sure(form) {\n      this.$refs[form].validate((valid) => {\n        if (valid) {\n          console.log(form, this.form);\n          if (this.state) {\n            info(this.form).then((res) => {\n              console.log(res);\n              if (res.status === 200) {\n                this.getData();\n                this.dialogFormVisible = false;\n                this.$message({ type: \"success\", message: res.data.message });\n              }\n            });\n          } else {\n            changeInfo(this.form).then((res) => {\n              if (res.status === 200) {\n                this.getData();\n                this.dialogFormVisible = false;\n                this.$message({ type: \"success\", message: res.data.message });\n              }\n            });\n          }\n        }\n      });\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.infoList {\n  .demo-form-inline,\n  .el-form-item {\n    text-align: left;\n  }\n  .el-pagination {\n    text-align: left;\n    margin-top: 20px;\n  }\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}