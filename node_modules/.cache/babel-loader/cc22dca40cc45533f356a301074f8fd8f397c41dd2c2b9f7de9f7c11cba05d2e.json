{"ast":null,"code":"import \"core-js/modules/esnext.array.with.js\";\nimport { asyncScheduler } from '../scheduler/async';\nimport { isValidDate } from '../util/isDate';\nimport { operate } from '../util/lift';\nimport { innerFrom } from '../observable/innerFrom';\nimport { createErrorClass } from '../util/createErrorClass';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { executeSchedule } from '../util/executeSchedule';\nexport var TimeoutError = createErrorClass(function (_super) {\n  return function TimeoutErrorImpl(info) {\n    if (info === void 0) {\n      info = null;\n    }\n    _super(this);\n    this.message = 'Timeout has occurred';\n    this.name = 'TimeoutError';\n    this.info = info;\n  };\n});\nexport function timeout(config, schedulerArg) {\n  var _a = isValidDate(config) ? {\n      first: config\n    } : typeof config === 'number' ? {\n      each: config\n    } : config,\n    first = _a.first,\n    each = _a.each,\n    _b = _a.with,\n    _with = _b === void 0 ? timeoutErrorFactory : _b,\n    _c = _a.scheduler,\n    scheduler = _c === void 0 ? schedulerArg !== null && schedulerArg !== void 0 ? schedulerArg : asyncScheduler : _c,\n    _d = _a.meta,\n    meta = _d === void 0 ? null : _d;\n  if (first == null && each == null) {\n    throw new TypeError('No timeout provided.');\n  }\n  return operate(function (source, subscriber) {\n    var originalSourceSubscription;\n    var timerSubscription;\n    var lastValue = null;\n    var seen = 0;\n    var startTimer = function (delay) {\n      timerSubscription = executeSchedule(subscriber, scheduler, function () {\n        try {\n          originalSourceSubscription.unsubscribe();\n          innerFrom(_with({\n            meta: meta,\n            lastValue: lastValue,\n            seen: seen\n          })).subscribe(subscriber);\n        } catch (err) {\n          subscriber.error(err);\n        }\n      }, delay);\n    };\n    originalSourceSubscription = source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n      timerSubscription === null || timerSubscription === void 0 ? void 0 : timerSubscription.unsubscribe();\n      seen++;\n      subscriber.next(lastValue = value);\n      each > 0 && startTimer(each);\n    }, undefined, undefined, function () {\n      if (!(timerSubscription === null || timerSubscription === void 0 ? void 0 : timerSubscription.closed)) {\n        timerSubscription === null || timerSubscription === void 0 ? void 0 : timerSubscription.unsubscribe();\n      }\n      lastValue = null;\n    }));\n    !seen && startTimer(first != null ? typeof first === 'number' ? first : +first - scheduler.now() : each);\n  });\n}\nfunction timeoutErrorFactory(info) {\n  throw new TimeoutError(info);\n}","map":{"version":3,"names":["asyncScheduler","isValidDate","operate","innerFrom","createErrorClass","createOperatorSubscriber","executeSchedule","TimeoutError","_super","TimeoutErrorImpl","info","message","name","timeout","config","schedulerArg","_a","first","each","_b","with","_with","timeoutErrorFactory","_c","scheduler","_d","meta","TypeError","source","subscriber","originalSourceSubscription","timerSubscription","lastValue","seen","startTimer","delay","unsubscribe","subscribe","err","error","value","next","undefined","closed","now"],"sources":["../../../../src/internal/operators/timeout.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}